define("vendor/ane/components/ms-select/ms-select.ts",function(e){"use strict";function t(e){return e.reduce(function(e,t){if("ms-select-option"!=t.is)return e;t.inlineTemplate;return e.push({label:t.inlineTemplate||"",value:t.props.value||"",disabled:t.props.disabled||!1}),e},[])}var n=e("node_modules/avalon2/dist/avalon"),i=e("vendor/ane/components/ms-form/ms-control.ts");e("vendor/ane/components/ms-trigger/index.ts");var l=e("vendor/ane/ane-util.ts"),s=e("vendor/ane/components/ms-form/utils.ts");i["default"].extend({displayName:"ms-select",template:'\n<div class="ane-select form-control "\n    :class="[(@isMultiple ? \'ane-select-multiple\' : \'\')] "\n    :click="@handleClick"\n    role="combobox"\n    aria-autocomplete="list"\n    aria-haspopup="true"\n    :attr="{\'aria-expanded\': @panelVisible + \'\'}">\n    <ul class="ane-select-selection " :class="[(@isMultiple ? \'ane-select-tags\' : \'\')] ">\n        <li class="ane-select-selected " :visible="!@isMultiple && (!@showSearch || !@panelVisible)">{{@displayValue}}</li>\n        <li class="ane-select-choice " :for="choice in @selection">\n            <span>{{choice.label}}</span>\n            <i class="fa fa-times " :click="@removeSelection($event, choice) | stop"></i>\n        </li>\n        <li class="ane-select-search ">\n            <input class="ane-select-search-field "\n                name="search"\n                type="text"\n                autocomplete="off"\n                :duplex="@searchValue"\n                :visible="@showSearch && @panelVisible"\n                :keydown="@handleDelete" />\n        </li>\n    </ul>\n    <i class="fa ane-select-arrow "\n        :class="[(@panelVisible ? \'fa-caret-up\' : \'fa-caret-down\')] "\n        :visible="@mode === \'\'"></i>\n    <ms-trigger :widget="{\n        width: @width,\n        visible: @panelVisible,\n        innerVmId: @panelVmId,\n        innerClass: @panelClass,\n        innerTemplate: @panelTemplate,\n        withInBox: @withInBox,\n        getTarget: @getTarget,\n        onHide: @handlePanelHide}">\n    </ms-trigger>\n</div>\n',defaults:{width:0,value:[],mode:"",options:[],selection:[],remote:!1,remoteMethod:n.noop,displayValue:"",showSearch:!1,searchValue:"",focusSearch:function(){this.$element.getElementsByTagName("input").search.focus()},withInBox:function(e){return this.$element===e||n.contains(this.$element,e)},getTarget:function(){return this.$element},handleClick:function(){this.panelVisible?this.isMultiple||(this.panelVisible=!1):(this.searchValue="",this.width=this.$element.offsetWidth,this.panelVisible=!0,this.focusSearch())},handleDelete:function(e){if((8===e.which||46===e.which)&&""===this.searchValue){this.selection.removeAt(this.selection.length-1);var t=this.selection.toJSON(),i=t.map(function(e){return e.value});n.vmodels[this.panelVmId].selection=t,this.handleChange({target:{value:this.isMultiple?i:i[0]||""},type:"select"})}},removeSelection:function(e,t){this.selection.removeAll(function(e){return e.value===t.value});var i=this.selection.toJSON(),l=i.map(function(e){return e.value});n.vmodels[this.panelVmId].selection=i,this.focusSearch(),this.handleChange({target:{value:this.isMultiple?l:l[0]||""},type:"select"})},panelVmId:"",panelVisible:!1,panelClass:"ane-select-dropdown",panelTemplate:'\n<div style="overflow: auto">\n    <ul class="ane-select-dropdown-menu " role="menu">\n        <li class="ane-select-dropdown-menu-item "\n            :class="[ (@selection.some(function(){return arguments[0].value===option.value}) ? \'ane-select-dropdown-menu-item-selected\' : \'\'), (option.disabled ? \'ane-select-dropdown-menu-item-disabled\' : \'\') ] "\n            :for="option in @getFilteredOptions()"\n            :click="@handleOptionClick($event, option)"\n            role="menuitem">\n            {{option.label}}\n            <i class="fa fa-check " :visible="@isMultiple"></i>\n        </li>\n        <li class="ane-select-dropdown-menu-item ane-select-dropdown-menu-item-disabled "\n            :visible="@getFilteredOptions().length <= 0 && @searchValue && !@loading">无数据</li>\n        <li class="ane-select-dropdown-menu-item ane-select-dropdown-menu-item-disabled "\n            :visible="@loading">加载中</li>\n    </ul>\n</div>\n',handlePanelHide:function(){this.panelVisible=!1},$computed:{isMultiple:{get:function(){return"multiple"===this.mode||"tags"===this.mode}}},mapValueToSelection:function(e){this.selection=this.options.filter(function(t){return e.contains(t.value)}),n.vmodels[this.panelVmId].selection=this.selection.toJSON()},onInit:function(){var e=this,i=this;if(0===this.options.length){var a=l.getChildTemplateDescriptor(this);this.options=t(a)}s.emitToFormItem(this),this.$watch("value",function(t){var n=t.toJSON();e.mapValueToSelection(t),e.handleChange({target:{value:e.isMultiple?n:n[0]||""},denyValidate:!0,type:"select"})}),this.panelVmId=this.$id+"_panel";var o=n.define({$id:this.panelVmId,selection:[],loading:!1,isMultiple:this.isMultiple,options:this.options.toJSON(),searchValue:"",getFilteredOptions:function(){return this.options.filter(this.filterFn)},filterFn:function(e){if(this.loading)return!1;if(i.remote)return!0;var t=new RegExp(n.escapeRegExp(this.searchValue),"i");return t.test(e.label)||t.test(e.value)},handleOptionClick:function(e,t){if(t.disabled)return!1;i.isMultiple?(this.selection.some(function(e){return e.value===t.value})?this.selection.removeAll(function(e){return e.value===t.value}):this.selection.push(t),i.focusSearch()):(this.selection=[t],i.panelVisible=!1);var n=this.selection.toJSON(),l=n.map(function(e){return e.value});i.handleChange({target:{value:i.isMultiple?l:l[0]||""},type:"select"}),i.displayValue=t.label,i.selection=n}});this.$watch("searchValue",l.debounce(function(t){o.searchValue=t,e.remote&&t&&(o.loading=!0,e.remoteMethod(t).then(function(e){o.loading=!1,o.options=e}))})),this.$watch("isMultiple",function(e){o.isMultiple=e}),this.mapValueToSelection(this.value)},onDispose:function(){delete n.vmodels[this.panelVmId]}}})});