define("vendor/ane/components/ms-upload/ms-upload.ts",function(e){"use strict";function t(e,t,i){e.forEach(function(e){return e.uid===t?(i(e),!1):void 0})}var i=e("vendor/ane/components/ms-form/ms-control.ts"),l=e("vendor/ane/components/ms-form/utils.ts");e("vendor/ane/components/ms-upload/ms-upload-list.ts"),e("vendor/ane/components/ms-upload/ms-upload-card.ts");var n=e("node_modules/up-loader/dist/up-loader");i["default"].extend({displayName:"ms-upload",template:'\n<div class="bus-upload-container ">\n    <div class="bus-upload-card-wall " :if="@showUploadList && @listType===\'picture-card\'">\n        <ms-upload-card :widget="{fileList: @fileList, onRemove: @handleRemove}"></ms-upload-card>\n    </div>\n    <label :visible="!@showUploadList && @listType===\'picture-card\' && @fileList.length > 0" class="bus-upload-card-item " :attr="{\'for\':@helpId}">\n        <img :attr="{src:@fileList[0]?@fileList[0].url:blankImg,alt:@fileList[0]?@fileList[0].name:\'\',title:@fileList[0]?@fileList[0].name:\'\'}">\n    </label>\n    <label :visible="@showUploadList || @fileList.length == 0" :class="[(@listType===\'picture-card\'?@cardClass:@btnClass)] " :attr="{\'for\':@helpId}"><slot /></label>\n    <form><input type="file" name="file" :attr="{id:@helpId}"></form>\n    <div :if="@showUploadList && @listType!==\'picture-card\'">\n        <ms-upload-list :widget="{fileList: @fileList, onRemove: @handleRemove}"></ms-upload-list>\n    </div>\n</div>\n',soleSlot:"trigger",defaults:{helpId:"",trigger:"",value:[],fileList:[],action:"",listType:"text-list",showUploadList:!0,btnClass:"btn btn-default",cardClass:"bus-upload-select-card bus-upload-card-item",blankImg:"data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",$uploader:null,beforeUpload:function(){return!0},handleRemove:function(e){this.fileList.removeAll(function(t){return t.uid===e.uid});var t=this.fileList.filter(function(e){return"done"===e.status}).map(function(e){return e.url});this.handleChange({target:{value:this.showUploadList?t:t[0]},type:"file-upload"})},mapValueToFileList:function(e){var t=this;e.map(function(e,i){""!==e&&t.fileList.push({uid:-(i+1),name:e.replace(/.*\/([^\/]+)\/?/,"$1"),url:e,status:"done",progress:0})})},onInit:function(){var e=this;l.emitToFormItem(this),this.helpId=this.$id,this.mapValueToFileList(this.value),this.$watch("value",function(t){var i=t.toJSON();e.fileList.clear(),e.mapValueToFileList(i),e.handleChange({target:{value:e.showUploadList?i:i[0]},denyValidate:!0,type:"file-upload"})})},onReady:function(e){var i=this;this.$uploader=n["default"].init({url:this.action,fileInput:e.target.getElementsByTagName("input").file,filter:function(e){return e.filter(function(e){return!e.size||i.beforeUpload(e)})},onSelect:function(e,l){l.map(function(e){return i.showUploadList?void(i.fileList.every(function(t){return t.uid!==e.index})?i.fileList.push({uid:e.index,name:e.name,status:"uploading",progress:0,url:i.blankImg}):t(i.fileList,e.index,function(e){e.status="uploading",e.progress=0})):void i.fileList.set(0,{uid:e.index,name:e.name,status:"uploading",progress:0,url:i.blankImg})}),i.$uploader.upload()},onProgress:function(e,l,n){t(i.fileList,e.index,function(e){return e.progress=(l/n*100).toFixed()})},onSuccess:function(e,l){t(i.fileList,e.index,function(e){e.status="done",e.progress=100,e.url=l.url})},onFailure:function(e,l){throw t(i.fileList,e.index,function(e){e.status="error",e.url="data:image/gif;base64,MA=="}),l},onComplete:function(){var e=i.fileList.filter(function(e){return"done"===e.status}).map(function(e){return e.url});i.handleChange({target:{value:i.showUploadList?e:e[0]},type:"file-upload"})}})},onDispose:function(){}}})});