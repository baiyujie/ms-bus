{"version":3,"sources":["/vendor/ane/components/ms-timepicker/ms-timepicker.ts"],"names":[],"mappings":"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","file":"ms-timepicker.js","sourcesContent":["import * as avalon from 'avalon2';\nimport * as moment from 'moment';\nimport controlComponent from '../ms-form/ms-control';\nimport '../ms-trigger';\nimport '../ms-timepicker/ms-timepicker-view'\nimport { emitToFormItem } from '../ms-form/utils';\n\n/**\n * 时间选择组件\n * @prop value 组件值(inherit)\n * @prop col 字段路径(inherit)\n * @prop format 日期格式，参考 momentjs，默认为 HH:mm:ss\n * \n * @example\n * ``` html\n * \n * ```\n */\ncontrolComponent.extend({\n    displayName: 'ms-timepicker',\n    template: __inline('./ms-timepicker.html'),\n    defaults: {\n        selected: '',\n        format: 'HH:mm:ss',\n        clear() {\n            this.selected = '';\n            avalon.vmodels[this.panelVmId].reset();\n            this.handleChange({\n                target: { value: '' },\n                type: 'timepicker-changed'\n            });\n        },\n        withInBox(el) {\n            return this.$element === el || avalon.contains(this.$element, el);\n        },\n        getTarget() {\n            return this.$element;\n        },\n        handleClick(e) {\n            if (!this.panelVisible) {\n                avalon.vmodels[this.panelVmId].reset();\n                this.panelVisible = true;\n            } else {\n                this.panelVisible = false;\n            }\n        },\n\n        panelVmId: '',\n        panelVisible: false,\n        panelClass: 'ane-timepicker-panel-container',\n        panelTemplate: `<div class=\"ane-timepicker-panel\" style=\"overflow: auto\">\n                            <xmp is=\"ms-timepicker-view\" :widget=\"{value:@currentDateArray,onChange:@handleTimepickerChange}\"></xmp>\n                        </div>`,\n        handlePanelHide() {\n            this.panelVisible = false;\n        },\n\n        mapValueToSelected(value) {\n            this.selected = value;\n        },\n        onInit: function (event) {\n            const self = this;\n            emitToFormItem(this, {\n                showIcon: false\n            });\n            this.$watch('value', v => {\n                this.mapValueToSelected(v);\n                this.handleChange({\n                    target: { value: v },\n                    denyValidate: true,\n                    type: 'timepicker-changed'\n                });\n            });\n            this.panelVmId = this.$id + '_panel';\n            const innerVm = avalon.define({\n                $id: this.panelVmId,\n                currentDateArray: '',\n                $moment: moment(),\n                reset() {\n                    this.$moment = self.selected ? moment(self.selected, self.format) : moment();\n                    this.currentDateArray = this.$moment.toArray().toString();\n                },\n                handleTimepickerChange(e) {\n                    const { hour, minute, second } = e.target;\n                    this.$moment.hour(hour).minute(minute).second(second);\n                    this.currentDateArray = this.$moment.toArray().toString();\n                    self.selected = this.$moment.format(self.format);\n\n                    self.handleChange({\n                        target: { value: self.selected },\n                        type: 'timepicker-changed'\n                    });\n                }\n            });\n            this.mapValueToSelected(this.value);\n            innerVm.reset();\n        },\n        onDispose() {\n            delete avalon.vmodels[this.panelVmId];\n        }\n    }\n});"]}