{"version":3,"sources":["/services/routerService.ts"],"names":[],"mappings":"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","file":"routerService.js","sourcesContent":["import * as avalon from 'avalon2';\nimport 'mmRouter';\n// import * as menuService from './menuService';\n\nfunction getPage(component) {\n    const html = `<xmp is=\"${component}\" :widget=\"{id:'${component.replace(/\\-/g, '_')}',expire:${Date.now()}}\"></xmp>`;\n    return html\n}\n\nfunction applyRouteConfig(config, parentRoute, accPath = '') {\n    config.map(function (route) {\n        let components:any = {};\n        if (route.component) {\n            components.currentPage = route.component;\n        }\n        if (route.components) {\n            components = route.components;\n        }\n        avalon.router.add(accPath + route.path, function () {\n            Object.keys(components).map(viewName => {\n                let component = components[viewName];\n                if (typeof component === 'function') {\n                    component(function (m) {\n                        avalon.vmodels[parentRoute.name][viewName] = getPage(m.name);\n                    });\n                } else {\n                    avalon.vmodels[parentRoute.name][viewName] = getPage(component.name);\n                }\n            });\n        });\n        // TODO 支持嵌套路由\n        //route.children && applyRouteConfig(route.children, route, accPath + route.path);\n    });\n}\n\nrequire('/components/common-header');\nrequire('/components/common-sidebar');\n\nconst routeConfig = [{\n    path: '/',\n    component(resolve) {\n        require.async('/components/gf-dashboard', resolve);\n    }\n}, { \n    path: '/aaa',\n    component(resolve) {\n        require.async('/components/gf-aaa', resolve);\n    }\n}, {\n    path: '/demo',\n    component(resolve) {\n        require.async('/components/gf-demo', resolve);\n    }\n}, {\n    path: '/demo-redux',\n    component(resolve) {\n        require.async('/components/gf-demo-redux', resolve);\n    }\n}, {\n    path: '/demo-fast',\n    component(resolve) {\n        require.async('/components/gf-demo-fast', resolve);\n    }\n}, {\n    path: '/doc-ms-table',\n    component(resolve) {\n        require.async('/components/doc-ms-table', resolve);\n    }\n}, {\n    path: '/doc-ms-form',\n    component(resolve) {\n        require.async('/components/doc-ms-form', resolve);\n    }\n}];\n\napplyRouteConfig(routeConfig, {\n    name: 'root'\n});\n\n// mmState全局配置\n// avalon.state.config({\n//     onError: function() {\n//         console.log('mmState配置出错：', arguments)\n//     },\n//     onLoad: function(fromStat, toState) {\n//         var breadCrumb = [], flagTree;\n//         var root = avalon.vmodels.root;\n//         menuService.walkMenu(toState.stateName, function (item, level) {\n//             breadCrumb.unshift(item);\n//         });\n//         if (breadCrumb.length) {\n//             flagTree = breadCrumb[breadCrumb.length-1]\n//             root.title = flagTree.title;\n//             avalon.vmodels.sidebar.actived = flagTree.name;\n//             avalon.mix(root, { breadCrumb: breadCrumb });\n//         }\n//     }\n// })"]}